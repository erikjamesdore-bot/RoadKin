<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RoadKin – Adventure Traveller Rescue Network</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="theme-color" content="#c00">
  <style>
    body {font-family:system-ui,sans-serif;background:#111;color:#fff;margin:0;padding:0;transition:background .3s,color .3s}
    @media (prefers-color-scheme:light){body{background:#fff;color:#000}}
    #app{max-width:480px;margin:40px auto;padding:20px}
    h1{text-align:center;color:#c00}
    input,textarea,button{width:100%;padding:12px;margin:8px 0;border-radius:8px;border:none;font-size:16px;box-sizing:border-box}
    button{background:#c00;color:white;cursor:pointer;font-weight:bold}
    button.bigbtn{padding:30px;font-size:24px;margin:30px 0;border-radius:12px}
    .sos{background:#b00;animation:pulse 2s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,0,0,.7)}70%{box-shadow:0 0 0 30px rgba(255,0,0,0)}100%{box-shadow:0 0 0 0 rgba(255,0,0,0)}}
    .helper{background:#222;padding:15px;margin:10px 0;border-radius:10px}
    @media (prefers-color-scheme:light){.helper{background:#f0f0f0}}
    .hidden{display:none}
    #install{background:#222}
    @media (prefers-color-scheme:light){#install{background:#ddd;color:#000}}
    footer{text-align:center;margin-top:40px;font-size:14px;opacity:0.7}
    .kofi{color:#c00;font-weight:bold}
  </style>
</head>
<body>
  <div id="app">
    <h1>RoadKin</h1>

    <div id="login" class="screen">
      <input type="text" id="username" placeholder="Your name or nickname" required>
      <button onclick="login()">Enter RoadKin</button>
      <p style="font-size:14px;opacity:0.7;margin-top:20px">Works 100 % offline after install</p>
    </div>

    <div id="main" class="screen hidden">
      <button id="install" class="bigbtn" onclick="installApp()" style="display:none">Install RoadKin (works offline)</button>
      <button class="bigbtn sos" onclick="sendSOS()">I NEED HELP NOW</button>
      <button onclick="toggleMode()">Switch to Helper Mode</button>
      <h2>Nearby Helpers (<span id="count">0</span>)</h2>
      <div id="helpers"></div>
    </div>

    <div id="helperMode" class="screen hidden">
      <h2>I Can Help!</h2>
      <textarea id="offer" placeholder="e.g. garage, welder, spare room, speaks Spanish, cold beer..."></textarea><br>
      <label><input type="checkbox" id="availableNow"> Available right now</label><br>
      <button onclick="saveHelperProfile()">Save My Profile</button>
      <button onclick="toggleMode()">Back to Rider Mode</button>
    </div>

    <footer>
      Built for the road less traveled
      <a href="https://roadkin.app" style="color:#c00">roadkin.app</a>
      <br><br>
      ❤️ Love RoadKin?
      <a href="https://ko-fi.com/roadkin" class="kofi" target="_blank">Buy me a beer</a>
    </footer>
  </div>

  <script>
    /* ← exact same script you already have → */
    let user = null;
    let deferredPrompt = null;
    let helpers = [ /* your full list stays here */ ];

    window.addEventListener('beforeinstallprompt', e => {e.preventDefault();deferredPrompt=e;document.getElementById('install').style.display='block'});
    async function installApp(){if(deferredPrompt){deferredPrompt.prompt();const o=await deferredPrompt.userChoice;if(o.outcome==='accepted')deferredPrompt=null}}
    if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js').catch(()=>{})}

    function login(){ /* unchanged */ }
    function renderHelpers(){ /* unchanged */ }
    function sendSOS(){ /* unchanged */ }
    function toggleMode(){document.getElementById("main").classList.toggle("hidden");document.getElementById("helperMode").classList.toggle("hidden")}
    function saveHelperProfile(){ /* unchanged */ }
    function haversine(/* unchanged */){}
    function callHelper(num){if(num)window.open(`tel:${num}`);else alert("No phone listed — use WhatsApp SOS!")}

    /* ← paste your full helpers array + all functions you already have here → */
  </script>
</body>
</html>
